{
  "info": {
    "name": "TechHub RBAC via Gateway/Proxy",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Profile (proxy)",
      "request": {
        "method": "GET",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" } ],
        "url": { "raw": "{{host}}/app/api/proxy/users/profile", "host": ["{{host}}"], "path": ["app","api","proxy","users","profile"] }
      }
    },
    {
      "name": "Permissions - List",
      "request": {
        "method": "GET",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" } ],
        "url": { "raw": "{{host}}/app/api/proxy/admin/permissions", "host": ["{{host}}"], "path": ["app","api","proxy","admin","permissions"] }
      }
    },
    {
      "name": "Permissions - Create",
      "request": {
        "method": "POST",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" }, { "key": "Content-Type", "value": "application/json" } ],
        "body": { "mode": "raw", "raw": "{\n  \"name\": \"USER_READ_ALL\",\n  \"description\": \"Get all users\",\n  \"url\": \"/api/users\",\n  \"method\": \"GET\",\n  \"resource\": \"USERS\",\n  \"active\": true\n}" },
        "url": { "raw": "{{host}}/app/api/proxy/admin/permissions", "host": ["{{host}}"], "path": ["app","api","proxy","admin","permissions"] }
      }
    },
    {
      "name": "Permissions - Update",
      "request": {
        "method": "PUT",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" }, { "key": "Content-Type", "value": "application/json" } ],
        "body": { "mode": "raw", "raw": "{\n  \"name\": \"USER_READ\",\n  \"description\": \"Get user by id\",\n  \"url\": \"/api/users/{id}\",\n  \"method\": \"GET\",\n  \"resource\": \"USERS\",\n  \"active\": true\n}" },
        "url": { "raw": "{{host}}/app/api/proxy/admin/permissions/{{permissionId}}", "host": ["{{host}}"], "path": ["app","api","proxy","admin","permissions","{{permissionId}}"] }
      }
    },
    {
      "name": "Roles - List",
      "request": {
        "method": "GET",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" } ],
        "url": { "raw": "{{host}}/app/api/proxy/admin/roles", "host": ["{{host}}"], "path": ["app","api","proxy","admin","roles"] }
      }
    },
    {
      "name": "Roles - Create",
      "request": {
        "method": "POST",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" }, { "key": "Content-Type", "value": "application/json" } ],
        "body": { "mode": "raw", "raw": "{\n  \"name\": \"CONTENT_REVIEWER\",\n  \"description\": \"Vai trò ki?m duy?t n?i dung\",\n  \"active\": true\n}" },
        "url": { "raw": "{{host}}/app/api/proxy/admin/roles", "host": ["{{host}}"], "path": ["app","api","proxy","admin","roles"] }
      }
    },
    {
      "name": "Roles - Update",
      "request": {
        "method": "PUT",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" }, { "key": "Content-Type", "value": "application/json" } ],
        "body": { "mode": "raw", "raw": "{\n  \"name\": \"INSTRUCTOR\",\n  \"description\": \"Gi?ng viên\",\n  \"active\": true\n}" },
        "url": { "raw": "{{host}}/app/api/proxy/admin/roles/{{roleId}}", "host": ["{{host}}"], "path": ["app","api","proxy","admin","roles","{{roleId}}"] }
      }
    },
    {
      "name": "Role - Assign Permissions",
      "request": {
        "method": "POST",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" }, { "key": "Content-Type", "value": "application/json" } ],
        "body": { "mode": "raw", "raw": "{\n  \"permissionIds\": [\"{{permissionId1}}\",\"{{permissionId2}}\"]\n}" },
        "url": { "raw": "{{host}}/app/api/proxy/admin/roles/{{roleId}}/permissions", "host": ["{{host}}"], "path": ["app","api","proxy","admin","roles","{{roleId}}","permissions"] }
      }
    },
    {
      "name": "Role - Remove Permission",
      "request": {
        "method": "DELETE",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" } ],
        "url": { "raw": "{{host}}/app/api/proxy/admin/roles/{{roleId}}/permissions/{{permissionId}}", "host": ["{{host}}"], "path": ["app","api","proxy","admin","roles","{{roleId}}","permissions","{{permissionId}}"] }
      }
    },
    {
      "name": "User - Get Roles",
      "request": {
        "method": "GET",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" } ],
        "url": { "raw": "{{host}}/app/api/proxy/admin/users/{{userId}}/roles", "host": ["{{host}}"], "path": ["app","api","proxy","admin","users","{{userId}}","roles"] }
      }
    },
    {
      "name": "User - Assign Roles",
      "request": {
        "method": "POST",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" }, { "key": "Content-Type", "value": "application/json" } ],
        "body": { "mode": "raw", "raw": "{\n  \"roleIds\": [\"{{roleId}}\"],\n  \"active\": true\n}" },
        "url": { "raw": "{{host}}/app/api/proxy/admin/users/{{userId}}/roles", "host": ["{{host}}"], "path": ["app","api","proxy","admin","users","{{userId}}","roles"] }
      }
    },
    {
      "name": "User - Remove Role",
      "request": {
        "method": "DELETE",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" } ],
        "url": { "raw": "{{host}}/app/api/proxy/admin/users/{{userId}}/roles/{{roleId}}", "host": ["{{host}}"], "path": ["app","api","proxy","admin","users","{{userId}}","roles","{{roleId}}"] }
      }
    },
    {
      "name": "User Permissions - Effective",
      "request": {
        "method": "GET",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" } ],
        "url": { "raw": "{{host}}/app/api/proxy/users/{{userId}}/permissions/effective", "host": ["{{host}}"], "path": ["app","api","proxy","users","{{userId}}","permissions","effective"] }
      }
    },
    {
      "name": "User Permissions - Upsert Override",
      "request": {
        "method": "POST",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" }, { "key": "Content-Type", "value": "application/json" } ],
        "body": { "mode": "raw", "raw": "{\n  \"permissionId\": \"{{permissionId}}\",\n  \"allowed\": true,\n  \"active\": true\n}" },
        "url": { "raw": "{{host}}/app/api/proxy/users/{{userId}}/permissions", "host": ["{{host}}"], "path": ["app","api","proxy","users","{{userId}}","permissions"] }
      }
    },
    {
      "name": "User Permissions - Check",
      "request": {
        "method": "POST",
        "header": [ { "key": "Authorization", "value": "Bearer {{token}}" }, { "key": "Content-Type", "value": "application/json" } ],
        "body": { "mode": "raw", "raw": "{\n  \"url\": \"/api/users\",\n  \"method\": \"GET\"\n}" },
        "url": { "raw": "{{host}}/app/api/proxy/users/{{userId}}/permissions/check", "host": ["{{host}}"], "path": ["app","api","proxy","users","{{userId}}","permissions","check"] }
      }
    }
  ],
  "variable": [
    { "key": "host", "value": "http://localhost:8443" },
    { "key": "token", "value": "" },
    { "key": "roleId", "value": "" },
    { "key": "permissionId", "value": "" },
    { "key": "permissionId1", "value": "" },
    { "key": "permissionId2", "value": "" },
    { "key": "userId", "value": "" }
  ]
}
